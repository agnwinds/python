#
# This is the makefile for the python related programs
#
# Make sure you have defined $PYTHON as this directory first
# then type
# 	make [GIT=False] install
#
# if this fails, consult https://github.com/agnwinds/python/wiki/Installing-Python
# for manual install.

CMAKE = mpicc
GIT = True


ifeq (True, $(GIT))
	CLONE_DATA =  mkdir $(PYTHON)/data; cd $(PYTHON)/data; git clone https://github.com/agnwinds/python.git -b data .
	CLONE_RELEASE = mkdir $(PYTHON)/progs; cd $(PYTHON)/progs; git clone https://github.com/agnwinds/python.git; cd python; make CC=$(CMAKE) python; make CC=$(CMAKE) py_wind; make CC=$(CMAKE) windsave2table
	PRINT_CLONE = 'Cloning Git Release'
else
	CLONE_DATA =
	CLONE_RELEASE =
	PRINT_CLONE = 'No git installed- have to obtain release and data manually from releases page on github. Exiting.'
endif

MAKE_SOURCE = cd $(PYTHON)/source; make CC=$(CMAKE) python; make CC=$(CMAKE) py_wind; make CC=$(CMAKE) windsave2table


# install for travis
travis_install:
	@echo 'Installing Python. the radiative transfer code'
	@echo 'Installing in directory '$(PYTHON)

	#finally, make the latest release
	@echo 'Making source code...'
	$(MAKE_SOURCE)
	@echo 'all done'


install:
	@echo 'Installing Python. the radiative transfer code'
	@echo 'Installing in directory '$(PYTHON)

	#finally, make the latest release
	@echo 'Making source code...'
	$(MAKE_SOURCE)
	@echo 'all done'

clean:
	rm -f *.o *~
	cd $(PYTHON)/source/; make clean
